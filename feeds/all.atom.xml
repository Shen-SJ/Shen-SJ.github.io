<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>SSJ's Blog</title><link href="https://shen-sj.github.io/" rel="alternate"></link><link href="https://shen-sj.github.io/feeds/all.atom.xml" rel="self"></link><id>https://shen-sj.github.io/</id><updated>2020-07-26T13:00:00+00:00</updated><entry><title>用 Python 將 AspenPlus 連接起來！！</title><link href="https://shen-sj.github.io/articles/2020/07/26/yong-python-jiang-aspenplus-lian-jie-qi-lai/" rel="alternate"></link><published>2020-07-26T13:00:00+00:00</published><updated>2020-07-26T13:00:00+00:00</updated><author><name>SSJ</name></author><id>tag:shen-sj.github.io,2020-07-26:/articles/2020/07/26/yong-python-jiang-aspenplus-lian-jie-qi-lai/</id><summary type="html">&lt;p&gt;最近被人家問要怎麼用 Python 把 AspenPlus 連接起來，突然想到其實我這部落格的創立就是想說寫一些 AspenPlus/Dynamics ...&lt;/p&gt;</summary><content type="html">&lt;h2&gt;&lt;i class="fas fa-crow"&gt;&lt;/i&gt;  前言&lt;/h2&gt;
&lt;p&gt;&amp;emsp;&amp;emsp;最近被人家問要怎麼用 Python 把 AspenPlus 連接起來，突然想到其實我這部落格的創立就是想說寫一些 AspenPlus/Dynamics 與
Python/Fortran 連接相關的說明書這樣，不然重新去看英文的說明書其實頗累的，我英文也不好...那今天就是先來介紹怎麼用 Python 將
AspenPlus 給連接起來吧~&lt;/p&gt;
&lt;h2&gt;&lt;i class="fas fa-crow"&gt;&lt;/i&gt;  目錄&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#安裝相關程式與packages"&gt;安裝相關程式與 packages&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#用Python連接AspenPlus檔案"&gt;用 Python 連接 AspenPlus 檔案&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#在AspenPlus中找指定變數的路徑"&gt;在 AspenPlus 中找指定變數的路徑&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#完整的code"&gt;完整的 code&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#結語"&gt;結語&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#參考資料"&gt;參考資料&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="安裝相關程式與packages"&gt;&lt;i class="fas fa-crow"&gt;&lt;/i&gt;  安裝相關程式與 packages&lt;/h2&gt;
&lt;p&gt;&amp;emsp;&amp;emsp;首先就是要先把你的 Python 與 AspenPlus 安裝起來，這我就不說了，網路上應該有很多相關的，就挑一個自己看得懂的來做即可。
&amp;emsp;&amp;emsp;如果上面的都OK了，接下來就是要安裝讓 Python 可以與各種電腦應用程式進行互動的套件——pypiwin32——，使用你的 pip 來安裝：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;pip install pypiwin32&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;安裝好了後可以在你的 python 裡面 import 看看有沒有錯誤：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;win32com.client&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;win32&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;如果沒有什麼輸出與錯誤表示安裝成功~&lt;/p&gt;
&lt;h2 id="用Python連接AspenPlus檔案"&gt;&lt;i class="fas fa-crow"&gt;&lt;/i&gt;  用 Python 連接 AspenPlus 檔案&lt;/h2&gt;
&lt;p&gt;&amp;emsp;&amp;emsp;首先就是先匯入這個模組包，然後使用模組包的&lt;code&gt;Dispatch()&lt;/code&gt;函式，傳入&lt;code&gt;'Apwn.Document'&lt;/code&gt;值告訴 Python 你要開啟
 AspenPlus 程式，如果你的電腦裡面有多種版本的 AspenPlus, 那可以傳&lt;code&gt;'Apwn.Document.{version_code}'&lt;/code&gt;指定你的 AspenPlus 版本，
 code 與 version_code 如下：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;win32com.client&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;win32&lt;/span&gt;

&lt;span class="n"&gt;aspen&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;win32&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Dispatch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Apwn.Document&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;        &lt;span class="c1"&gt;# 使用你電腦預設 AspenPlus 版本開啟&lt;/span&gt;
&lt;span class="n"&gt;aspen2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;win32&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Dispatch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Apwn.Document.36.0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;   &lt;span class="c1"&gt;# 使用 AspenPlus V10.0 開啟&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;↓ AspenPlus 版本與版本號的對應&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align="center"&gt;版本&lt;/th&gt;
&lt;th align="center"&gt;版本號&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td align="center"&gt;V8.8&lt;/td&gt;
&lt;td align="center"&gt;34.0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="center"&gt;V9&lt;/td&gt;
&lt;td align="center"&gt;35.0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="center"&gt;V10&lt;/td&gt;
&lt;td align="center"&gt;36.0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="center"&gt;V11&lt;/td&gt;
&lt;td align="center"&gt;37.0&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&amp;emsp;&amp;emsp;在這邊你取的變數名稱可以說就是代表你的 AspenPlus 程式了，之後對 AspenPlus 程式的操作都要用這個變數來進行，在這裡我
取名叫做&lt;strong&gt;aspen&lt;/strong&gt;。接下來操控 AspenPlus 的語法都是在 UserGuide 上 &lt;strong&gt;Using the Aspen Plus ActiveX Automation Server&lt;/strong&gt; 
面找得到的了~通常呼叫了 AspenPlus 軟體後就是要開啟指定檔案，UserGuide 上說&lt;code&gt;InitFromArchive2(filename as String,...)&lt;/code&gt;
函式傳入檔案的絕對路徑就可以開啟檔案了，就像下面的 code 這樣：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;aspen&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;InitFromArchive2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;C:&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s2"&gt;Simulation 1.apw&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;      &lt;span class="c1"&gt;# 開啟 C:\Simulation 1.apw 的檔案&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;可以開始用 Python 操控你的檔案了！！&lt;/p&gt;
&lt;h2 id="在AspenPlus中找指定變數的路徑"&gt;&lt;i class="fas fa-crow"&gt;&lt;/i&gt;  在 AspenPlus 中找指定變數的路徑&lt;/h2&gt;
&lt;p&gt;&amp;emsp;&amp;emsp;檔案開啟是開啟了，但如果你要把一些值抓出來或是用 Python 輸入進去，例如抓取/設定某蒸餾塔的塔板數還是不知道怎麼辦啊，
這時候我們就必須知道那個值在 AspenPlus 程式裡的甚麼地方並且呼叫他，我們可以用 AspenPlus 裡面的 &lt;strong&gt;Variable Explorer&lt;/strong&gt;找尋，
他在 AspenPlus Simulation 介面中的 Costomize 裡面：
&lt;img alt="找出VariableExplorer" src="https://drive.google.com/uc?export=view&amp;amp;id=14r8tbpsfy6xHFiuq2GJ2AQgJikGcOy6z"&gt;&lt;/p&gt;
&lt;p&gt;點開來裡面就是一個階層式的資料索引，所有在 AspenPlus 檔案裡面的資料都在這裡面了！我們可以在裡面找到想要的變數路徑~
&lt;img alt="DataTree" src="https://drive.google.com/uc?export=view&amp;amp;id=1HfBMYRRJGDe-eeAlcc1BjGXC3dqoJhE3"&gt;&lt;/p&gt;
&lt;p&gt;不過其實這樣慢慢找蠻累的，有些看著索引名稱還好找，但有些真的是...，還好還是有方便的功能可以幫你快速找尋路徑！首先到你想要找的
那個變數，這邊就以名為 B1 的蒸餾塔塔頂壓力為例子好了，在壓力那個數字給他複製起來：
&lt;img alt="CopyVariable" src="https://drive.google.com/uc?export=view&amp;amp;id=11CoxHJEQVBsmIw7JmiXyv4Nu6AHJt5tn"&gt;&lt;/p&gt;
&lt;p&gt;再來就到你的 Variable Explorer 那邊，於階層瀏覽空白那邊隨便地方點右鍵並按下&lt;strong&gt;Go to Node&lt;/strong&gt;：
&lt;img alt="click go to node" src="https://drive.google.com/uc?export=view&amp;amp;id=15GHLgZgnf3HTxsPTrjmRUH8Bu9uQMseP"&gt;&lt;/p&gt;
&lt;p&gt;你會發現搜尋輸入框裡面已經有東西在裡面了！但那還不是你的路徑，就先按下&lt;strong&gt;OK&lt;/strong&gt;讓他去找：
&lt;img alt="go_to_node_enter" src="https://drive.google.com/uc?export=view&amp;amp;id=15_7nLws1rR0jFfdgeLrGD0-4ShabrdNp"&gt;&lt;/p&gt;
&lt;p&gt;哇~他除了幫你找到結果還幫你打開了階層清單呢~真是不錯~在右邊表格那邊的資訊欄中就可以得知關於 B1 塔的塔頂壓力這物件的程式相關資訊，
其中的&lt;strong&gt;Path to Node&lt;/strong&gt;與&lt;strong&gt;Call&lt;/strong&gt;這兩個路徑都可以在程式裡面呼叫，再來就是用這個路徑呼叫其他關於這物件的屬性了，這裡要注意，
路徑裡面的開頭&lt;strong&gt;Application&lt;/strong&gt;就是我們前面建立的&lt;strong&gt;aspen&lt;/strong&gt;變數。
&lt;img alt="找到路徑了！" src="https://drive.google.com/uc?export=view&amp;amp;id=1hrD3RA6p_hbch4h0OZe4gCrdlkADQ10U"&gt;&lt;/p&gt;
&lt;p&gt;假設現在你要得到這塔頂壓力的值是多少，從表格來看，&lt;strong&gt;Value&lt;/strong&gt;屬性應該就是你的壓力值，程式就可以這樣寫：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;b1_p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;aspen&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Tree&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Data&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Blocks&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;B1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Input&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;PRES1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Value&lt;/span&gt;
&lt;span class="n"&gt;b1_p2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;aspen&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Tree&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;FindNode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;\Data\Blocks\B1\Input\PRES1&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Value&lt;/span&gt;    &lt;span class="c1"&gt;# 跟上面那行的作用是一樣的&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;前面的路徑只是把 Application 改成我們取名的 aspen 而已，基本上一樣，再來就是&lt;strong&gt;.Value&lt;/strong&gt;來得到我們的值這樣，另外要設定這個值
也是非常簡單，就跟平常妳寫程式用&lt;strong&gt;=&lt;/strong&gt;來做就好：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;aspen&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Tree&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Data&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Blocks&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;B1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Input&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;PRES1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Value&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;
&lt;span class="n"&gt;aspen&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Tree&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;FindNode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;\Data\Blocks\B1\Input\PRES1&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Value&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;    &lt;span class="c1"&gt;# 跟上面那行的作用是一樣的&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;現在我把壓力設為 2 bar 了~&lt;/p&gt;
&lt;h2 id="完整的code"&gt;&lt;i class="fas fa-crow"&gt;&lt;/i&gt;  完整的 code&lt;/h2&gt;
&lt;p&gt;&amp;emsp;&amp;emsp;上面的 code 為了要解說感覺有點亂，就在這邊寫一次完整的 code 吧~&lt;br&gt;
目標：用 Python 連接 AspenPlus V8.8 的 Simulation 1.apw 檔案，讀取 B1 塔的塔頂壓力並將其改成 2 bar。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;win32com.client&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;win32&lt;/span&gt;     &lt;span class="c1"&gt;# 匯入所需模組包&lt;/span&gt;

&lt;span class="n"&gt;aspen&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;win32&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Dispatch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Apw.Document.34.0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;     &lt;span class="c1"&gt;# 開啟 AspenPlus V8.8 程式&lt;/span&gt;
&lt;span class="n"&gt;aspen&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;InitFromArchive2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;C:&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s1"&gt;Simulation 1.apw&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c1"&gt;# 打開 C:\\Simulation 1.apw 檔案&lt;/span&gt;

&lt;span class="n"&gt;b1_p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;aspen&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Tree&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Data&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Blocks&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;B1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Input&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;PRES1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Value&lt;/span&gt;  &lt;span class="c1"&gt;# 取得 B1 塔頂壓力的值&lt;/span&gt;

&lt;span class="n"&gt;aspen&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Tree&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;FindNode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;\Data\Blocks\B1\Input\PRES1&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Value&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;   &lt;span class="c1"&gt;# 將 B1 塔頂壓力改為 2 bar&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2 id="結語"&gt;&lt;i class="fas fa-crow"&gt;&lt;/i&gt;  結語&lt;/h2&gt;
&lt;p&gt;&amp;emsp;&amp;emsp;以上就是一個非常簡單得如何用 Python 連接 AspenPlus 的方式，裡面其實還有很多功能與坑沒說到，功能的話大部分 UserGuiude 都會介紹到，
可以去參考參考，真的覺得 UserGuide 算是蠻重要的，可以好好的看看，那坑的話像是你要取用的屬性如 Physical Quantity 這種名子裡面有空格
該怎麼辦，這有機會就再介紹了QQ&lt;/p&gt;
&lt;h2 id="參考資料"&gt;&lt;i class="fas fa-crow"&gt;&lt;/i&gt;  參考資料&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href="http://kitchingroup.cheme.cmu.edu/blog/2013/06/14/Running-Aspen-via-Python/"&gt;Running Aspen via Python&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Aspen Plus User Guide&lt;/li&gt;
&lt;/ol&gt;</content><category term="blogging"></category><category term="AspenPlus"></category><category term="Python"></category></entry><entry><title>Fiddler 無法抓取封包之 port 占用...</title><link href="https://shen-sj.github.io/articles/2020/06/05/fiddler-wu-fa-zhua-qu-feng-bao-zhi-port-zhan-yong/" rel="alternate"></link><published>2020-06-05T22:30:00+00:00</published><updated>2020-06-05T22:30:00+00:00</updated><author><name>SSJ</name></author><id>tag:shen-sj.github.io,2020-06-05:/articles/2020/06/05/fiddler-wu-fa-zhua-qu-feng-bao-zhi-port-zhan-yong/</id><summary type="html">&lt;p&gt;最近在寫網路爬蟲有用到 Fiddler 抓包軟體幫我看看用自己寫的程式送出與接收到的封包內容與直接用瀏覽器做這些動作有什麼不一樣...&lt;/p&gt;</summary><content type="html">&lt;h2&gt;&lt;i class="fas fa-crow"&gt;&lt;/i&gt;  事發經過&lt;/h2&gt;
&lt;p&gt;最近在寫網路爬蟲有用到 Fiddler 抓包軟體幫我看看用自己寫的程式送出與接收到的封包內容與直接用瀏覽器做這些動作有什麼不一樣，
進而去做一些程式碼的修改，一開始這個 Fiddler 抓包都用得好好的，但突然有一天一樣用 Fiddler 抓取我運行的爬蟲程式封包時候居然出現：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;Traceback (most recent call last):&lt;/span&gt;
&lt;span class="err"&gt;  File &amp;quot;main.py&amp;quot;, line 426, in &amp;lt;module&amp;gt;&lt;/span&gt;
&lt;span class="err"&gt;  File &amp;quot;main.py&amp;quot;, line 363, in scrapping&lt;/span&gt;
&lt;span class="err"&gt;  File &amp;quot;main.py&amp;quot;, line 125, in login&lt;/span&gt;
&lt;span class="err"&gt;  File &amp;quot;site-packages\requests\sessions.py&amp;quot;, line 546, in get&lt;/span&gt;
&lt;span class="err"&gt;  File &amp;quot;site-packages\requests\sessions.py&amp;quot;, line 533, in request&lt;/span&gt;
&lt;span class="err"&gt;  File &amp;quot;site-packages\requests\sessions.py&amp;quot;, line 646, in send&lt;/span&gt;
&lt;span class="err"&gt;  File &amp;quot;site-packages\requests\adapters.py&amp;quot;, line 510, in send&lt;/span&gt;
&lt;span class="err"&gt;requests.exceptions.ProxyError: HTTPSConnectionPool(host=&amp;#39;my.ntu.edu.tw&amp;#39;, port=443): Max retries exceeded with url: /stuLeaveManagement/login.aspx?firstpage=teacher (Caused by ProxyError(&amp;#39;Cannot connect to proxy.&amp;#39;, OSError(&amp;#39;Tunnel connection failed: 405 Method Not Allowed&amp;#39;)))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;平常不是都用得好好的嗎？怎麼突然就這樣了@@ 而且不只程式出現問題，我連瀏覽器都沒辦法上網了!由上面的情況與爆出的錯誤來看，
感覺起來應該不是程式碼上的問題了(我也記得我沒改甚麼東西...)。雖然上面的錯誤訊息沒有看得很懂，但是我覺得可能是 port 的問題，
Fiddler 會用到 port:8888(如下圖)，
&lt;img alt="Fiddler的port設定" src="https://drive.google.com/uc?export=view&amp;amp;id=1HY4hsEWbwKzNCIMkMMt-QHVDnWIxzs4r"&gt;&lt;/p&gt;
&lt;h2&gt;&lt;i class="fas fa-crow"&gt;&lt;/i&gt;  調查過程&lt;/h2&gt;
&lt;p&gt;可能是不知道被誰佔用了吧~當然要直接改 Fiddler 的 port 應該是可以的，但還是想要知道是甚麼程式在佔用，萬一是駭客怎麼辦@@
因此就趕快上網查了一下 windows 查詢系統 port 的指令...，原來是&lt;code&gt;netstat -ano&lt;/code&gt;啊~還順便查詢了參數的意義，
由於太多參數了，我就列出這次會用到的三個就好，如果想要知道其他的參數意義，就在自己的 windows 電腦輸入&lt;code&gt;netstat /?&lt;/code&gt;吧~&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;NETSTAT&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;option&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;顯示所有連線和接聽連接埠&lt;/span&gt;&lt;span class="err"&gt;。&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;以數字格式顯示位址和連接埠號碼&lt;/span&gt;&lt;span class="err"&gt;。&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;o&lt;/span&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;顯示與每個連線相關聯的擁有處理程序識別碼&lt;/span&gt;&lt;span class="err"&gt;。&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;喔...既然知道的指令與參數意義就來查詢看看吧!&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;C&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="err"&gt;\&lt;/span&gt;&lt;span class="n"&gt;Users&lt;/span&gt;&lt;span class="err"&gt;\&lt;/span&gt;&lt;span class="n"&gt;SSJ&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;netstat&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;ano&lt;/span&gt;

&lt;span class="err"&gt;使用中連線&lt;/span&gt;

  &lt;span class="err"&gt;協定&lt;/span&gt;   &lt;span class="err"&gt;本機位址&lt;/span&gt;               &lt;span class="err"&gt;外部位址&lt;/span&gt;               &lt;span class="err"&gt;狀態&lt;/span&gt;            &lt;span class="n"&gt;PID&lt;/span&gt;
  &lt;span class="n"&gt;TCP&lt;/span&gt;    &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;111&lt;/span&gt;            &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;              &lt;span class="n"&gt;LISTENING&lt;/span&gt;       &lt;span class="mi"&gt;4280&lt;/span&gt;
  &lt;span class="n"&gt;TCP&lt;/span&gt;    &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;135&lt;/span&gt;            &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;              &lt;span class="n"&gt;LISTENING&lt;/span&gt;       &lt;span class="mi"&gt;764&lt;/span&gt;
  &lt;span class="n"&gt;TCP&lt;/span&gt;    &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;443&lt;/span&gt;            &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;              &lt;span class="n"&gt;LISTENING&lt;/span&gt;       &lt;span class="mi"&gt;4156&lt;/span&gt;
    &lt;span class="p"&gt;...&lt;/span&gt;
    &lt;span class="p"&gt;...&lt;/span&gt;
    &lt;span class="p"&gt;...&lt;/span&gt;
    &lt;span class="p"&gt;...&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;痾...好像有點多啊，要我一個一個去找 port:8888 也太累了吧...還好還有一個指令可以幫我們做這件事情，那就是&lt;code&gt;find&lt;/code&gt;：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;FIND &amp;lt;你想要搜尋的字串&amp;gt; &amp;lt;檔名:對哪個檔案進行搜尋&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;但我們沒有要對甚麼檔案進行搜尋啊，難道還要把&lt;code&gt;netstat -ano&lt;/code&gt;的結果先輸出成檔案在搜尋嗎？哪有這麼白癡的設計，在這情況我們可以利用「|」
(pipe)符號來達成我們的目的，整個指令就變成了&lt;code&gt;netstat -ano | find "8888"&lt;/code&gt;，雖然運作原理不是很懂，但我想他運作機制簡單來說
應該就是將「|」左側&lt;code&gt;netstat -ano&lt;/code&gt;所輸出的結果丟到「|」右側指令的輸入去，畫成簡圖應該是這樣：
&lt;img alt="pipe的簡單解釋圖" src="https://drive.google.com/uc?export=view&amp;amp;id=1ludInCg-c_9Wwva3yOAfrHsOhSzvp2w6"&gt;&lt;/p&gt;
&lt;p&gt;所以這串指令就可以幫我們找到誰在佔用 port:8888 囉~&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c"&gt;C:\Users\SSJ&amp;gt;netstat -ano | find &amp;quot;8888&amp;quot;&lt;/span&gt;
&lt;span class="c"&gt;  TCP    127.0.0.1:8888         0.0.0.0:0              LISTENING       27140&lt;/span&gt;
&lt;span class="c"&gt;  TCP    [::1]:8888             [::]:0                 LISTENING       27140&lt;/span&gt;
&lt;span class="c"&gt;  UDP    0.0.0.0:28888          *:*                                    4156&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;喔...看起來有點複查啊，不過好像是看第一行結果（為什麼是看那行，原因有點複雜...反正就先查查看也不錯ˊˇˋ），得知是 PID=27140 
這程式佔用了，那就到工作管理員&amp;gt;&amp;gt;處理程序來看看誰是 PID=27140，如果你的工作管理員&amp;gt;&amp;gt;處理程序沒有顯示 PID 的話，就在任一個欄位名稱點右鍵
，把 PID 打勾就好了：
&lt;img alt="叫出PID" src="https://drive.google.com/uc?export=view&amp;amp;id=1xhGMGhNhVXpfeAEtTWuxJOmZgAPei7mG"&gt;&lt;/p&gt;
&lt;h2&gt;&lt;i class="fas fa-crow"&gt;&lt;/i&gt;  找到你了!!&lt;/h2&gt;
&lt;p&gt;&lt;img alt="PID為27140的傢伙" src="https://drive.google.com/uc?export=view&amp;amp;id=1DMdIv2JaibjNW2T9k9eeytwYStjrBXfQ"&gt;
　　喔喔就是你！終於抓到了~看起來是個 python 的執行檔案，目前我好像沒有在跑什麼東西所以關掉應該沒差吧~果然關掉後我的程式重跑就沒問題了，
瀏覽器也可以正常的上網了~~~~&lt;/p&gt;</content><category term="blogging"></category><category term="Fiddler"></category><category term="CMD"></category><category term="Windows"></category></entry><entry><title>用SoftEther架設自己的VPN</title><link href="https://shen-sj.github.io/articles/2020/03/29/yong-softetherjia-she-zi-ji-de-vpn/" rel="alternate"></link><published>2020-03-29T15:30:00+00:00</published><updated>2020-03-29T15:30:00+00:00</updated><author><name>SSJ</name></author><id>tag:shen-sj.github.io,2020-03-29:/articles/2020/03/29/yong-softetherjia-she-zi-ji-de-vpn/</id><summary type="html">&lt;p&gt;一些可憐的~~菸酒生~~在家也想要查查文獻、看看paper，但學校又沒有提供VPN的話，那可是一件非常痛苦的事情啊...，難道只能去實驗室用電腦了嗎?!&lt;/p&gt;</summary><content type="html">&lt;p&gt;一些可憐的~~菸酒生~~在家也想要查查文獻、看看paper，但學校又沒有提供VPN的話，那可是一件非常痛苦的事情啊...，難道只能去實驗室用電腦了嗎?!
有一個方法就是使用遠端桌面連回實驗室電腦，通常這可以利用一些軟體(如:Teamviewer, Anydesk...)或是你電腦的windows系統是專業版、
教育版、...等等(~~反正不是家用版就對了~~)就能夠辦到，不過我又覺得我只是想要使用學校的這個IP來查詢資料，直接連回電腦會不會太大費周章了@@?
所以我就想使用另外一個方法，在學校電腦自己架一個VPN Server，不過架設的過程是稍嫌複雜，本人也是研究了好幾天才大概能用...
好不容易成功了就記錄一下整個流程吧~不然我怕之後還會用到的話我卻忘了QQ
以下的步驟都是參考以下幾篇文章所得到的心得，我把網址附在最下面，有需要的同學可以去參考參考，基本上步驟都跟他們一樣啦 :))
那就開始吧!!!&lt;/p&gt;
&lt;h2&gt;使用軟體與作業系統&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;SoftEtherVPN&lt;/li&gt;
&lt;li&gt;Windows10 企業版 ((家用版應該也是可以吧...&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;架設VPN Server&lt;/h2&gt;
&lt;p&gt;首先我是去官方網站下載該軟體，進到官網就是找到 Download&amp;gt;&amp;gt;Download SoftEtherVPN 並進入&lt;br&gt;
&lt;img alt="到官網下載軟體" src="https://drive.google.com/uc?export=view&amp;amp;id=1eTgL6-_xB3h-5hZN1swOy8e67P1H54xr"&gt;&lt;/p&gt;
&lt;p&gt;選擇適合你的選項，像我是windows系統，系統就選windows，然後就會看到下面出現很多連結，最上面的應該是最新版本，應該也是可以用啦，
不過我是選擇稍微就一點的版本就是，~~總是有傳言最新的比較不穩定~~，我是用Ver4.31給大家參考參考&lt;br&gt;
&lt;img alt="選擇軟體" src="https://drive.google.com/uc?export=view&amp;amp;id=1NXG6ihAma2wSLFlIZJlwH12ZDCppEYUk"&gt;&lt;/p&gt;
&lt;p&gt;選了想要的版本後他應該就會開始下載了，等下載完就點兩下開始安裝，就下一步~&lt;br&gt;
&lt;img alt="開始安裝" src="https://drive.google.com/uc?export=view&amp;amp;id=167LByeywEKjDZrHQ7i6uU6rU7cP58DVf"&gt;&lt;/p&gt;
&lt;p&gt;因為我們就是要建立一個VPN Server，所以選SoftEther VPN Server後就下一步~&lt;br&gt;
&lt;img alt="選SoftEther VPN Server" src="https://drive.google.com/uc?export=view&amp;amp;id=1DEWHyPRsFv5yfoY_M1JXSAZa1klDu6LQ"&gt;&lt;/p&gt;
&lt;p&gt;後面就是一些許可與軟體訊息什麼的，看過後沒問題就可以下一步了~&lt;br&gt;
&lt;img alt="用戶許可協議" src="https://drive.google.com/uc?export=view&amp;amp;id=1vmSzhNeYSre1_K_rw7SAOQKt_O6Bi3A6"&gt;
&lt;img alt="重要訊息" src="https://drive.google.com/uc?export=view&amp;amp;id=1Q6Eg_uHkPheDzQLsQY2tR4yh3crQepvN"&gt;&lt;/p&gt;
&lt;p&gt;指定好你軟體要安裝在那裡就繼續((我是使用預設而已&lt;br&gt;
&lt;img alt="指定安裝目錄" src="https://drive.google.com/uc?export=view&amp;amp;id=1PUneC8sQ0EGJvbR20QSFWzUlW3Wx5gji"&gt;&lt;/p&gt;
&lt;p&gt;開始安裝!!&lt;br&gt;
&lt;img alt="進行安裝" src="https://drive.google.com/uc?export=view&amp;amp;id=16azoj2LZMon5ZaTFzn34cZ_uGqdc9BOT"&gt;&lt;/p&gt;
&lt;p&gt;咕嚕咕嚕咕嚕......&lt;br&gt;
&lt;img alt="正在安裝" src="https://drive.google.com/uc?export=view&amp;amp;id=1Rhrs8yfG85t82FhuA1jr3tHTgEOKAeJO"&gt;&lt;/p&gt;
&lt;p&gt;耶~~~ 安裝好了~~~&lt;br&gt;
&lt;img alt="安裝好了" src="https://drive.google.com/uc?export=view&amp;amp;id=1CQwC0npVoZpx3U7iyZg5QGF-Gp_LrQao"&gt;&lt;/p&gt;
&lt;p&gt;安裝好了如果直接按完成，他應該會幫你開啟 SoftEther VPN Server 管理工具，這時你可以看到他已經預先幫你建立了一個連線設置，
我們就直接點那個設置兩下進行一些設定吧~&lt;br&gt;
&lt;img alt="本地主機設置" src="https://drive.google.com/uc?export=view&amp;amp;id=1j-U6aETP2CiBAr8G017sB0SmVX0u8AQF"&gt;&lt;/p&gt;
&lt;p&gt;因為我們是第一次進去這設置，所以他會叫你建立管理者密碼，之後如果身為管理者的你要進去這設置管理一些設定的話會需要用到這密碼~&lt;br&gt;
&lt;img alt="設定管理者密碼" src="https://drive.google.com/uc?export=view&amp;amp;id=1kHyXodJTdRGnIt-aOstLXG25xVIknbeL"&gt;&lt;/p&gt;
&lt;p&gt;密碼設定好了之後應該會跳出這東西，好像可以幫你簡單的安裝一些設定啦，但我是直接關閉等等自己設定這樣&lt;br&gt;
&lt;img alt="server簡單安裝" src="https://drive.google.com/uc?export=view&amp;amp;id=1qz5J9yBqSUY5vAjHmKWwZ8jUw4NRPC8f"&gt;&lt;/p&gt;
&lt;p&gt;關閉後他就會問你要不要設置IPsec，那我們就確定，因為等等連線會用到這東西~&lt;br&gt;
&lt;img alt="是否設定IPsec" src="https://drive.google.com/uc?export=view&amp;amp;id=14N0lXy7MV0Y8H32_4cDFesLWRV6uVcdL"&gt;&lt;/p&gt;
&lt;p&gt;&lt;span id="IPsecPS"&gt;關於這東西的設置我是勾選第一個框框"啟動L2TP服務器功能(L2TP over IPsec)"，再來最下面那個密碼必須要設定並好好保存，
之後要連到你這VPN會需要的~&lt;br&gt;
&lt;img alt="IPsec設定" src="https://drive.google.com/uc?export=view&amp;amp;id=1pPml1GTZ5A36b-6A2WZQ7m8qpKKNFcAq"&gt;&lt;/p&gt;
&lt;p&gt;到了這畫面表示快好了!!我們還有一個設定需要設定才能連上，首先先點"管理虛擬HUB"
&lt;img alt="管理HUB" src="https://drive.google.com/uc?export=view&amp;amp;id=1lS9dpiIHOOfD0tR5VlTp0GbVLrvVflKI"&gt;&lt;/p&gt;
&lt;p&gt;再來進入"虛擬NAT和虛擬DHCP服務器"裡面
&lt;img alt="進入&amp;quot;虛擬NAT和虛擬DHCP服務器&amp;quot;" src="https://drive.google.com/uc?export=view&amp;amp;id=1ULYX5e9PSJZHMEp-FOGYEo6x4P2hvuuk"&gt;&lt;/p&gt;
&lt;p&gt;點選"啟用SecureNAT"就可以囉~"SecureNAT配置"我是使用預設的，如果有懂得朋友也可以進去裡面客製一下~好了就可以關閉本畫面回到管理HUB畫面了
&lt;img alt="啟用SecureNAT" src="https://drive.google.com/uc?export=view&amp;amp;id=1HTIz9ffHnu7np1n-E5ipRatx4OfdhtLA"&gt;&lt;/p&gt;
&lt;p&gt;別人要使用你這台VPN需要透過帳號跟密碼，身為管理者的你就需要替他們建立帳號跟密碼囉，這樣除了比較安全外也可以限制有誰可以使用你的VPN，
因此我們點選"管理用戶"來新增用戶
&lt;img alt="管理用戶" src="https://drive.google.com/uc?export=view&amp;amp;id=1r4s8pfYxxYoVoJEXnhyQZEQrCZnbffUf"&gt;&lt;/p&gt;
&lt;p&gt;你可以看到這裡什麼用戶都沒有，所以還沒有人可以使用你的VPN，我們點選"新建"
&lt;img alt="管理用戶" src="https://drive.google.com/uc?export=view&amp;amp;id=1Z1AAoERrf3yBBnyitAbL5rSa3YblpnSH"&gt;&lt;/p&gt;
&lt;p&gt;在這邊你就可以輸入新用戶的帳號跟密碼，至少我圖中兩個紅色框框部分需要設定，其他部分例如限制使用時段、
驗證類型等等如果你會且有需要的話也可以去做設定~
&lt;img alt="建立用戶" src="https://drive.google.com/uc?export=view&amp;amp;id=1vs_VaMlG52Sky-uzU_G-z4PQHeAb40Wq"&gt;&lt;/p&gt;
&lt;p&gt;終於可以使用了!!可以請人家用用看囉~~
&lt;img alt="建立完成" src="https://drive.google.com/uc?export=view&amp;amp;id=1BSp_1-0VSdfSxW409ck7HJNgUFDX2FCp"&gt;&lt;/p&gt;
&lt;h2&gt;在windows中使用VPN&lt;/h2&gt;
&lt;p&gt;首先必須到你windows電腦裡的 設定&amp;gt;&amp;gt;網路和網際網路&amp;gt;&amp;gt;VPN，來新建一個VPN連線
&lt;img alt="建立VPN" src="https://drive.google.com/uc?export=view&amp;amp;id=1yUNKpnD3YIA28te70TtZ6GP1tZmDNHRq"&gt;&lt;/p&gt;
&lt;p&gt;然後就輸入所需要的資訊，像是:
* 連線名稱: 自己知道這VPN是甚麼就好，跟你的server沒關係~
* 伺服器名稱或位址: 就是你架的VPN Server的IP
* VPN類型: L2TP/IPsec(使用預先共用金鑰)
* 預先共用金鑰: 就是你在&lt;a href="#IPsecPS"&gt;這步驟&lt;/a&gt;所設的密碼
* 使用者名稱: 管理者幫你建立的帳號
* 密碼: 管理者幫你設定的密碼&lt;br&gt;
&lt;img alt="輸入VPN資訊" src="https://drive.google.com/uc?export=view&amp;amp;id=10B12HEKyKHRvsOedJ09UCpBkuJwdaPvW"&gt;&lt;/p&gt;
&lt;p&gt;都輸入完就可以儲存囉~~再來你點選你工具列右下角的網路圖示，可以發現到多了你剛剛新增個VPN，當你想要使用這VPN查paper的時候就按連線&lt;br&gt;
&lt;img alt="建立VPN連線" src="https://drive.google.com/uc?export=view&amp;amp;id=1V8V7ckrFyLtnplXLJafVBpGoCSUvgTRY"&gt;&lt;/p&gt;
&lt;p&gt;出現已連線就是成功了，恭喜你!!!&lt;br&gt;
&lt;img alt="VPN連線成功!" src="https://drive.google.com/uc?export=view&amp;amp;id=1vvrpHAjJM02kIxwNklYrEDoBFknnWidY"&gt;&lt;/p&gt;
&lt;p&gt;參考資料:&lt;br&gt;
&lt;a href="https://zh.wikipedia.org/wiki/SoftEther_VPN"&gt;https://zh.wikipedia.org/wiki/SoftEther_VPN&lt;/a&gt;
&lt;a href="https://noter.tw/4524/softether-vpn-%E6%9E%B6%E8%A8%AD%E8%A8%98%E9%8C%84/"&gt;https://noter.tw/4524/softether-vpn-%E6%9E%B6%E8%A8%AD%E8%A8%98%E9%8C%84/&lt;/a&gt;
&lt;a href="https://jjnux.blogspot.com/2017/02/softether-vpn-server-windows.html"&gt;https://jjnux.blogspot.com/2017/02/softether-vpn-server-windows.html&lt;/a&gt;
&lt;a href="https://it001.pixnet.net/blog/post/328610332-it%E5%B0%88%E9%A1%8C--%E5%AE%89%E8%A3%9Dsoftethervpn-%28l2tp-ipsec%29"&gt;https://it001.pixnet.net/blog/post/328610332-it%E5%B0%88%E9%A1%8C--%E5%AE%89%E8%A3%9Dsoftethervpn-%28l2tp-ipsec%29&lt;/a&gt;&lt;/p&gt;</content><category term="blogging"></category><category term="VPN"></category><category term="SoftEther VPN"></category></entry><entry><title>用Pelican搞部落格遇到的python import模組問題...</title><link href="https://shen-sj.github.io/articles/2020/03/28/yong-pelicangao-bu-luo-ge-yu-dao-de-python-importmo-zu-wen-ti/" rel="alternate"></link><published>2020-03-28T23:00:00+00:00</published><updated>2020-03-28T23:00:00+00:00</updated><author><name>SSJ</name></author><id>tag:shen-sj.github.io,2020-03-28:/articles/2020/03/28/yong-pelicangao-bu-luo-ge-yu-dao-de-python-importmo-zu-wen-ti/</id><summary type="html">&lt;p&gt;最近一直在練習用Pelican寫部落格，不過之前我設定專案的時候好像沒設定好，publishconf.py裡面沒有把pelicanconfi.py裡的設定給匯入...&lt;/p&gt;</summary><content type="html">&lt;p&gt;最近一直在練習用Pelican寫部落格，不過之前我設定專案的時候好像沒設定好，publishconf.py裡面沒有把pelicanconfi.py裡的設定給匯入，
所以我就自己把&lt;code&gt;from pelicanconf import *&lt;/code&gt;給加了進去，但每次當我要把目前的東西輸出成檔案在CMD下
&lt;code&gt;pelican content -s publishconf.py&lt;/code&gt;指令的時候`,就會出現這個錯誤...  &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;CRITICAL&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;ModuleNotFoundError&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;No&lt;/span&gt; &lt;span class="n"&gt;module&lt;/span&gt; &lt;span class="n"&gt;named&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;pelicanconf&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;疑?奇怪，pelicanconf.py 跟 publishconf.py 是在同一個資料夾，而且我不是有import了嗎?!怎麼他會找不到呢...
因此我就確認了一下publishconf.py在工作的時候的路徑是長怎樣，我就在我那檔案添加了這段程式碼:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;sys&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;然後就用CMD再給他run一次，結果...&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;C:&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s1"&gt;Users&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s1"&gt;SSJ&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s1"&gt;Anaconda3&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s1"&gt;envs&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s1"&gt;myblog&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s1"&gt;Scripts&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s1"&gt;pelican.exe&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;c:&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s1"&gt;users&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s1"&gt;ssj&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s1"&gt;anaconda3&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s1"&gt;envs&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s1"&gt;myblog&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s1"&gt;python37.zip&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;......&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;怎麼沒有看到我的工作目錄哩...看來只好給他加上去了，但我發現其實Pelican有考慮到這點已經幫你加好了XDDD，只是我import的語句應該在目錄加
進去之後，這樣才不會有問題，因此程式碼就變成了:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;os&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;sys&lt;/span&gt;
&lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;curdir&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;pelicanconf&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;然後終於成功了@@ 可以繼續專心研究搞部落格了...&lt;/p&gt;</content><category term="blogging"></category><category term="Python"></category><category term="Pelican"></category></entry><entry><title>圖片測試_外部連結</title><link href="https://shen-sj.github.io/articles/2020/03/02/tu-pian-ce-shi-_wai-bu-lian-jie/" rel="alternate"></link><published>2020-03-02T12:00:00+00:00</published><updated>2020-03-02T12:00:00+00:00</updated><author><name>SSJ</name></author><id>tag:shen-sj.github.io,2020-03-02:/articles/2020/03/02/tu-pian-ce-shi-_wai-bu-lian-jie/</id><summary type="html">&lt;p&gt;這是一篇測試能不能顯示外部連結圖片的文章~&lt;/p&gt;</summary><content type="html">&lt;p&gt;這是一篇測試能不能顯示外部連結圖片的文章~
&lt;img alt="bird logo" src="https://drive.google.com/uc?export=view&amp;amp;id=1vCd1eCSRQDtOCWGQBesdTtna-LVPaWsW"&gt;&lt;/p&gt;</content><category term="test"></category><category term="picture"></category></entry><entry><title>show the picture</title><link href="https://shen-sj.github.io/articles/2020/03/01/show-the-picture/" rel="alternate"></link><published>2020-03-01T12:00:00+00:00</published><updated>2020-03-01T12:00:00+00:00</updated><author><name>SSJ</name></author><id>tag:shen-sj.github.io,2020-03-01:/articles/2020/03/01/show-the-picture/</id><content type="html">&lt;p&gt;&lt;img alt="bird logo" src="https://shen-sj.github.io/img/bird.jpg"&gt;&lt;/p&gt;</content><category term="test"></category><category term="picture"></category></entry><entry><title>Test for icon and underline title</title><link href="https://shen-sj.github.io/articles/2020/03/01/test-for-icon-and-underline-title/" rel="alternate"></link><published>2020-03-01T12:00:00+00:00</published><updated>2020-03-01T12:00:00+00:00</updated><author><name>SSJ</name></author><id>tag:shen-sj.github.io,2020-03-01:/articles/2020/03/01/test-for-icon-and-underline-title/</id><summary type="html">&lt;p&gt;[the brief of article show in the index.html]&lt;/p&gt;</summary><content type="html">&lt;h2&gt;&lt;i class="fas fa-crow"&gt;&lt;/i&gt;測試我的標題&lt;/h2&gt;
&lt;hr&gt;</content><category term="Test"></category><category term="icon"></category></entry><entry><title>Markdown Examples Part 1</title><link href="https://shen-sj.github.io/articles/2019/01/02/markdown-examples-part-1/" rel="alternate"></link><published>2019-01-02T12:00:00+00:00</published><updated>2019-01-02T12:00:00+00:00</updated><author><name>Matthew Devaney</name></author><id>tag:shen-sj.github.io,2019-01-02:/articles/2019/01/02/markdown-examples-part-1/</id><summary type="html">&lt;p&gt;Basic markdown examples are shown below&lt;/p&gt;</summary><content type="html">&lt;p&gt;Basic markdown examples are shown below&lt;/p&gt;
&lt;p&gt;This text is &lt;strong&gt;bold&lt;/strong&gt;
This text is also &lt;strong&gt;bold&lt;/strong&gt;
⋯
This text is &lt;em&gt;italic&lt;/em&gt;
This text is also &lt;em&gt;italic&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;This text is &lt;strong&gt;&lt;em&gt;italic and bold&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;h1&gt;An h1 heading&lt;/h1&gt;
&lt;h2&gt;An h2 heading&lt;/h2&gt;
&lt;h3&gt;An h3 heading...&lt;/h3&gt;
&lt;h6&gt;An h6 heading&lt;/h6&gt;
&lt;p&gt;A list with numbers:
1. One
2. Two
3. Three&lt;/p&gt;
&lt;p&gt;A list with bullets:
* Bullet
* Bullet
* Bullet&lt;/p&gt;
&lt;p&gt;Here's a blockquote:&lt;/p&gt;
&lt;p&gt;&amp;gt; Simple is better than complex&lt;/p&gt;
&lt;p&gt;Here's a table:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Column1&lt;/th&gt;
&lt;th&gt;Column 2&lt;/th&gt;
&lt;th&gt;Column 3&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Value 1&lt;/td&gt;
&lt;td&gt;Value 2&lt;/td&gt;
&lt;td&gt;Value 3&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Value 4&lt;/td&gt;
&lt;td&gt;Value 5&lt;/td&gt;
&lt;td&gt;Value 6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Value 7&lt;/td&gt;
&lt;td&gt;Value 8&lt;/td&gt;
&lt;td&gt;Value 9&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Here's a python script&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;login&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="c1"&gt;# 先開啟起始網頁取得初始cookies取得權限&lt;/span&gt;
    &lt;span class="n"&gt;pre_web&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pre_url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                          &lt;span class="n"&gt;headers&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;nor_headers&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;pre_cookies&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;utils&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dict_from_cookiejar&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cookies&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="c1"&gt;# 登入學校系統&lt;/span&gt;
    &lt;span class="n"&gt;login_web&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;post&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;login_url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                             &lt;span class="n"&gt;headers&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;nor_headers&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                             &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;login_data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;login_cookies&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;utils&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dict_from_cookiejar&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cookies&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;remove_cookie_by_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cookies&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;PHPSESSID&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c1"&gt;# 不知道 cookie 多了不必要的PHPSESSID會不會怎樣，先刪除好了&lt;/span&gt;

    &lt;span class="c1"&gt;# 檢查登入有沒有失敗&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;login_web&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;search_url&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;raise&lt;/span&gt; &lt;span class="n"&gt;LoginError&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;登入失敗!!!&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;login_web&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</content><category term="test"></category><category term="markdown"></category></entry></feed>